# WARNING - Generated by {fusen} from /dev/flat_export_excel.Rmd: do not edit by hand

test_that("mon_classeur fonctionne correctement and envoie une erreur quand il le faut", {
  mon_classeur <- openxlsx::createWorkbook()
  nom_page <- "nom_onglet"
  openxlsx::addWorksheet(mon_classeur, "iris")
  openxlsx::addWorksheet(mon_classeur, "cars")
  openxlsx::writeData(wb = mon_classeur, sheet = "iris", x = iris)
  openxlsx::writeData(wb = mon_classeur, sheet = "cars", x = mtcars)

  expect_error(taille_colonnes(classeur = "mon_classeur",
                               liste_type_donnees = list(c("decimal",
                                                           "decimal",
                                                           "decimal",
                                                           "decimal",
                                                           "texte"),
                                                          c("numerique",
                                                            "numerique",
                                                            "decimal",
                                                            "numerique",
                                                            "numerique",
                                                            "numerique")),
                                largeurs = list(c("auto"), c("auto")),
                                format = "primeur",
                                col_debut = 2),
               "Classeur doit \u00eatre un workbook. Lancer un createWorkbook avant de lancer l'ajout de tableau.")
  expect_error(taille_colonnes(classeur = mon_classeur,
                               liste_type_donnees = "numerique",
                                largeurs = list(c("auto"), c("auto")),
                                format = "primeur",
                                col_debut = 2),
               "La liste des types de donn\u00e9es doit \u00eatre de type list.")
  
  expect_error(taille_colonnes(classeur = mon_classeur,
                               liste_type_donnees = list(c(5,
                                                           "decimal",
                                                           "decimal",
                                                           "decimal",
                                                           "texte"),
                                                          c("numerique",
                                                            "numerique",
                                                            "decimal",
                                                            "numerique",
                                                            "numerique",
                                                            "numerique")),
                                largeurs = list(c("auto"), c("auto")),
                                format = "primeur",
                                col_debut = 2),
               "La liste des types de donn\u00e9es doit \u00eatre une liste contenant des vecteurs de cha\u00eenes de caract\u00e8re parmi 'texte', 'numerique' et 'decimal'.")
  expect_error(taille_colonnes(classeur = mon_classeur,
                               liste_type_donnees = list(c("decimal",
                                                           "decimal",
                                                           "decimal",
                                                           "decimal",
                                                           "texte"),
                                                          c("numerique",
                                                            "numerique",
                                                            "decimal",
                                                            "numerique",
                                                            "numerique",
                                                            "numerique")),
                                largeurs = list(c("18"), c("auto")),
                                format = "primeur",
                                col_debut = 2),
               "Probl\u00e8me dans la colonne Taille_colonnes, tableau 1. Veuillez la v\u00e9rifier.")
  expect_error(taille_colonnes(classeur = mon_classeur,
                               liste_type_donnees = list(c("decimal",
                                                           "decimal",
                                                           "decimal",
                                                           "decimal",
                                                           "texte"),
                                                          c("numerique",
                                                            "numerique",
                                                            "decimal",
                                                            "numerique",
                                                            "numerique",
                                                            "numerique")),
                                largeurs = list(c("auto"), c("20")),
                                format = "primeur",
                                col_debut = 2),
               "Probl\u00e8me dans la colonne Taille_colonnes, tableau 2. Veuillez la v\u00e9rifier.")
  expect_error(taille_colonnes(classeur = mon_classeur,
                               liste_type_donnees = list(c("decimal",
                                                           "decimal",
                                                           "decimal",
                                                           "decimal",
                                                           "texte"),
                                                          c("numerique",
                                                            "numerique",
                                                            "decimal",
                                                            "numerique",
                                                            "numerique",
                                                            "numerique")),
                                largeurs = list(c("auto"), c("auto")),
                                format = "rep Ã  la demande",
                                col_debut = 2),
               'Le format doit \u00eatre "chiffres_et_donnees" ou "primeur".')
  expect_error(taille_colonnes(classeur = mon_classeur,
                               liste_type_donnees = list(c("decimal",
                                                           "decimal",
                                                           "decimal",
                                                           "decimal",
                                                           "texte"),
                                                          c("numerique",
                                                            "numerique",
                                                            "decimal",
                                                            "numerique",
                                                            "numerique",
                                                            "numerique")),
                                largeurs = list(c("auto"), c("auto")),
                                format = "primeur",
                                col_debut = "B"),
               'La colonne de d\u00e9but doit \u00eatre un entier positif.')
  expect_error(taille_colonnes(classeur = mon_classeur,
                               liste_type_donnees = list(c("decimal",
                                                           "decimal",
                                                           "decimal",
                                                           "decimal",
                                                           "texte"),
                                                          c("numerique",
                                                            "numerique",
                                                            "decimal",
                                                            "numerique",
                                                            "numerique",
                                                            "numerique")),
                                largeurs = list(c("auto"), c("auto")),
                                format = "primeur",
                                col_debut = 2,
                                largeur_max = "oui"),
               "Le param\u00e8tre largeur_max doit \u00eatre TRUE ou FALSE.")
})
