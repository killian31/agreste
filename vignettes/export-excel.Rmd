---
title: "Export excel"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{export-excel}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(agreste)
```

<!-- WARNING - This vignette is generated by {fusen} from /dev/flat_export_excel.Rmd: do not edit by hand -->

# Créer un tableau excel formaté depuis un plan

Cette fonction permet de formater un ensemble de tableaux dans un classeur Excel, en suivant un plan défini, qui indique comment formater chaque tableau : largeurs et types de colonnes, de lignes, titre, source...


```{r examples-creer_excel_depuis_plan, eval = FALSE}
library(agreste)
library(dplyr)
library(openxlsx)
library(rstudioapi)
### Import du fichier de plan
plan = agreste::modele_plan

### Création des csv 
agreste::resultat_1 %>%
  write.csv(file = "resultat_1.csv", row.names = FALSE)
agreste::resultat_2 %>%
  write.csv(file = "resultat_2.csv", row.names = FALSE)
agreste::resultat_3 %>%
  write.csv(file = "resultat_3.csv", row.names = FALSE)
agreste::lait_vache %>%
  write.xlsx(file = "lait_vache.xlsx", row.names = FALSE)
agreste::scieries2020 %>%
  write.xlsx(file = "scieries2020.xlsx", row.names = FALSE)
write.xlsx(plan, "plan.xlsx", row.names = FALSE)

### Formatage
workbook <- creer_excel_depuis_plan(plan = "plan.xlsx",
                                    datadir = selectDirectory(),
                                    format = "primeur",
                                    col_debut = 2,
                                    save = TRUE,
                                    path = "document_a_envoyer.xlsx",
                                    type_virgule = ".")

```

# Lire un fichier de n'importe quel type (courant)

Permet de lire un fichier de type csv, tsv, xlsx, rds, parquet


```{r examples-read_any_file, eval = FALSE}
#' \dontrun{
library(agreste)
write.csv(iris, "iris.csv", row.names = FALSE, sep = ",")
df <- read_any_file(filename = "iris.csv", header = TRUE, sep = ",", decimal_mark = ".")
#'}
```

