[{"path":"/articles/application-shiny-formatage.html","id":"ouvrir-linterface-graphique-du-package","dir":"Articles","previous_headings":"","what":"Ouvrir l’interface graphique du package","title":"Application Shiny Formatage","text":"Cette fonction permet de lancer une interface graphique Shiny, dans le de faciliter la création d’un plan, qui pourra être réutilisé par la suite avec la fonction creer_excel_depuis_plan().","code":"library(agreste) #' \\dontrun{ app_formatage() #' }"},{"path":"/articles/creer-des-cartes.html","id":"créer-les-données-de-fond-de-carte","dir":"Articles","previous_headings":"","what":"Créer les données de fond de carte","title":"Creer des cartes","text":"","code":"data_geo_france_region_metro <- donnees_fond_carte(zone_geographique = \"france\", niveau_representation = \"region_metro\") data_geo_france_dep_metro <- donnees_fond_carte(zone_geographique = \"france\", niveau_representation = \"departement_metro\")"},{"path":"/articles/creer-des-cartes.html","id":"carte-avec-symbole-proportionnel","dir":"Articles","previous_headings":"","what":"Carte avec symbole proportionnel","title":"Creer des cartes","text":"","code":"library(agreste) library(dplyr) ### récupération des données de permis de construire de SITADEL  permis_construire_region_2020 <- agreste::permis_construire_region %>%    filter(annee_autorisation == 2020)  ### création de la carte et sauvegarde du fichier carte carte_pc_2020 <- carte_rond_proportionnel(df = permis_construire_region_2020, colonne_code_zone_geo = REG, colonne_volume = PC, titre_carte = \"Carte 1\", sous_titre_carte = \"Nombre de permis de construire délivré en 2020 par région\", titre_legende_volume = \"Nombre de permis de construire\", save_carte = TRUE, path_carte = \"carteReg.png\")  ### ouverture de la carte browseURL(\"carteReg.png\")  # Pour faire par département : permis_construire_dep_2020 <- agreste::permis_construire_dep %>%   filter(annee_autorisation == 2020)  carte_pc_2020 <- carte_rond_proportionnel(df = permis_construire_dep_2020, colonne_code_zone_geo = DEP, colonne_volume = PC, niveau_representation = \"departement_metro\", titre_carte = \"Carte 2\", sous_titre_carte = \"Nombre de permis de construire délivré en 2020 par département\", titre_legende_volume = \"Nombre de permis de construire\", save_carte = TRUE, path_carte = \"carteDEP.png\", taille_max_rond = 3)  browseURL(\"carteDEP.png\")"},{"path":"/articles/creer-des-cartes.html","id":"carte-en-aplat-de-couleurs","dir":"Articles","previous_headings":"","what":"Carte en aplat de couleurs","title":"Creer des cartes","text":"","code":"library(agreste) library(dplyr) ### récupération des données de permis de construire de SITADEL  permis_construire_region_2020 <- agreste::permis_construire_region %>%    filter(annee_autorisation == 2020)  ### création de la carte et plot carte_pc_2020 <- carte_aplat(df = permis_construire_region_2020, colonne_code_zone_geo = REG, colonne_volume = PC, titre_carte = \"Carte 1\", sous_titre_carte = \"Nombre de permis de construire délivré en 2020 par région\", titre_legende_volume = \"Nombre de permis de construire\", save_carte = FALSE)"},{"path":"/articles/export-excel.html","id":"fonctions-dédition-dun-classeur-excel","dir":"Articles","previous_headings":"","what":"Fonctions d’édition d’un classeur Excel","title":"Export excel","text":"Ces fonctions agissent sur des objets de type workbook (du package openxlsx), en ajoutant des données, des titres, des sources…","code":""},{"path":"/articles/export-excel.html","id":"creer-une-liste-de-style-excel","dir":"Articles","previous_headings":"Fonctions d’édition d’un classeur Excel","what":"Creer une liste de style Excel","title":"Export excel","text":"","code":"library(agreste) mes_styles <- creer_liste_style_excel(format = \"chiffres_et_donnees\")  #exemples mes_styles$ligne_titre mes_styles$numerique"},{"path":"/articles/export-excel.html","id":"ajouter-un-tableau-excel","dir":"Articles","previous_headings":"Fonctions d’édition d’un classeur Excel","what":"Ajouter un tableau Excel","title":"Export excel","text":"","code":"# Création d'un classeur avec une feuille contenant iris et une feuille contenant airquality # Sauvegarde du classeur # Ouverture du classeur library(openxlsx) library(agreste) mon_classeur <- createWorkbook()  mes_styles <- creer_liste_style_excel()  start_ligne = 3 start_col = 2 nb_col = ncol(iris)  ajouter_tableau_excel(classeur = mon_classeur, tableau = iris, nom_feuille = \"iris\") addStyle(wb = mon_classeur, sheet = \"iris\", style = mes_styles$ligne_titre, rows = start_ligne, cols = start_col:(nb_col+start_col-1)) addStyle(wb = mon_classeur, sheet = \"iris\", style = mes_styles$decimal, rows = (start_ligne+1):(nrow(iris)+start_ligne), cols = 2) addStyle(wb = mon_classeur, sheet = \"iris\", style = mes_styles$decimal, rows = (start_ligne+1):(nrow(iris)+start_ligne), cols = 3) addStyle(wb = mon_classeur, sheet = \"iris\", style = mes_styles$decimal, rows = (start_ligne+1):(nrow(iris)+start_ligne), cols = 4) addStyle(wb = mon_classeur, sheet = \"iris\", style = mes_styles$decimal_italique, rows = (start_ligne+1):(nrow(iris)+start_ligne), cols = 5) addStyle(wb = mon_classeur, sheet = \"iris\", style = mes_styles$texte, rows = (start_ligne+1):(nrow(iris)+start_ligne), cols = 6)  start_ligne = 3 start_col = 2 nb_col = ncol(airquality)  ajouter_tableau_excel(classeur = mon_classeur, tableau = airquality, nom_feuille = \"airquality\") addStyle(wb = mon_classeur, sheet = \"airquality\", style = mes_styles$ligne_titre, rows = start_ligne, cols = start_col:(nb_col+start_col-1)) addStyle(wb = mon_classeur, sheet = \"airquality\", style = mes_styles$numerique, rows = (start_ligne+1):(nrow(airquality)+start_ligne), cols = 2) addStyle(wb = mon_classeur, sheet = \"airquality\", style = mes_styles$numerique, rows = (start_ligne+1):(nrow(airquality)+start_ligne), cols = 3) addStyle(wb = mon_classeur, sheet = \"airquality\", style = mes_styles$decimal, rows = (start_ligne+1):(nrow(airquality)+start_ligne), cols = 4) addStyle(wb = mon_classeur, sheet = \"airquality\", style = mes_styles$numerique, rows = (start_ligne+1):(nrow(airquality)+start_ligne), cols = 5) addStyle(wb = mon_classeur, sheet = \"airquality\", style = mes_styles$numerique, rows = (start_ligne+1):(nrow(airquality)+start_ligne), cols = 6) addStyle(wb = mon_classeur, sheet = \"airquality\", style = mes_styles$numerique, rows = (start_ligne+1):(nrow(airquality)+start_ligne), cols = 7)  saveWorkbook(wb = mon_classeur, file = \"tableau.xlsx\", overwrite = TRUE)  browseURL(\"tableau.xlsx\")"},{"path":"/articles/export-excel.html","id":"ajouter-un-titre-à-un-primeur","dir":"Articles","previous_headings":"Fonctions d’édition d’un classeur Excel","what":"Ajouter un titre à un primeur","title":"Export excel","text":"","code":"library(openxlsx) library(agreste) mon_classeur <- createWorkbook()  mes_styles <- creer_liste_style_excel(format = \"primeur\")  start_ligne = 5 start_col = 2 nb_col = ncol(iris)  ajouter_tableau_excel(classeur = mon_classeur,                       tableau = iris,                       nom_feuille = \"iris\",                       ligne_debut = 5)  ## Formatage  addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$ligne_titre,          rows = start_ligne,          cols = start_col:(nb_col+start_col-1)) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 2) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 3) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 4) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$decimal_italique,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 5) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$texte,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 6)  ## Ajout du titre   ajouter_titre_primeur(classeur = mon_classeur,                       titre = \"Iris\")  ## Sauvegarde saveWorkbook(wb = mon_classeur,              file = \"tableau.xlsx\",              overwrite = TRUE)  browseURL(\"tableau.xlsx\")"},{"path":"/articles/export-excel.html","id":"ajouter-le-titre-dun-tableau","dir":"Articles","previous_headings":"Fonctions d’édition d’un classeur Excel","what":"Ajouter le titre d’un tableau","title":"Export excel","text":"","code":"library(openxlsx) library(agreste)  ## Création d'un classeur  mon_classeur <- createWorkbook()  mes_styles <- creer_liste_style_excel(format = \"chiffres_et_donnees\")  start_ligne = 3 start_col = 2 nb_col = ncol(iris)  ajouter_tableau_excel(classeur = mon_classeur,                       tableau = iris,                       nom_feuille = \"iris\")  ## Formatage  addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$ligne_titre,          rows = start_ligne,          cols = start_col:(nb_col+start_col-1)) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 2) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 3) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 4) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$decimal_italique,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 5) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$texte,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 6)  ## Ajout du titre   ajouter_titre_tableau(classeur = mon_classeur,                       nom_feuille = \"iris\",                       titre = \"Données fleurs iris\",                       col_debut = 2,                       format = \"chiffres_et_donnees\")  ## Deuxième feuille  start_ligne = 3 start_col = 2 nb_col = ncol(airquality)  ajouter_tableau_excel(classeur = mon_classeur,                       tableau = airquality,                       nom_feuille = \"airquality\")  addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$ligne_titre,          rows = start_ligne,          cols = start_col:(nb_col+start_col-1)) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 2) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 3) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 4) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 5) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 6) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 7)  ajouter_titre_tableau(classeur = mon_classeur,                       nom_feuille = \"airquality\",                       titre = \"Données qualité de l'air\",                       col_debut = 2)  saveWorkbook(wb = mon_classeur,              file = \"tableau.xlsx\",              overwrite = TRUE)  browseURL(\"tableau.xlsx\")"},{"path":"/articles/export-excel.html","id":"ajouter-une-note-de-lecture","dir":"Articles","previous_headings":"Fonctions d’édition d’un classeur Excel","what":"Ajouter une note de lecture","title":"Export excel","text":"","code":"# Création d'un classeur avec une feuille contenant iris et une feuille contenant airquality # Ajout d'une note de lecture # Sauvegarde du classeur # Ouverture du classeur library(openxlsx) library(agreste) mon_classeur <- createWorkbook()  mes_styles <- creer_liste_style_excel()  start_ligne = 3 start_col = 2 nb_col = ncol(iris)  ajouter_tableau_excel(classeur = mon_classeur,                       tableau = iris,                       nom_feuille = \"iris\") addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$ligne_titre,          rows = start_ligne,          cols = start_col:(nb_col+start_col-1)) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 2) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 3) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 4) addStyle(wb = mon_classeur,          sheet = \"iris\",         style = mes_styles$decimal_italique,         rows = (start_ligne+1):(nrow(iris)+start_ligne),         cols = 5) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$texte,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 6)  ajouter_titre_tableau(classeur = mon_classeur,                       nom_feuille = \"iris\",                       titre = \"Iris\",                       col_debut = start_col,                       format = \"chiffres_et_donnees\")  ajouter_note_lecture(classeur = mon_classeur,                      nom_feuille = \"iris\",                      note = \"Ceci est une note de lecture\",                      col_debut = 2)  start_ligne = 3 start_col = 2 nb_col = ncol(airquality)  ajouter_tableau_excel(classeur = mon_classeur,                       tableau = airquality,                       nom_feuille = \"airquality\")  addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$ligne_titre,          rows = start_ligne,          cols = start_col:(nb_col+start_col-1)) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 2) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 3) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 4) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 5) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 6) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 7)  ajouter_titre_tableau(classeur = mon_classeur,                       nom_feuille = \"airquality\",                       titre = \"Données qualité de l'air\",                       col_debut = 2)  ajouter_note_lecture(classeur = mon_classeur,                      nom_feuille = \"airquality\",                      note = \"Ceci est une autre note de lecture\",                      col_debut = 2)  saveWorkbook(wb = mon_classeur, file = \"tableau.xlsx\", overwrite = TRUE)  browseURL(\"tableau.xlsx\")"},{"path":"/articles/export-excel.html","id":"ajouter-la-source","dir":"Articles","previous_headings":"Fonctions d’édition d’un classeur Excel","what":"Ajouter la source","title":"Export excel","text":"","code":"# Création d'un classeur avec une feuille contenant iris et une feuille contenant airquality # Ajout de la source # Sauvegarde du classeur # Ouverture du classeur library(openxlsx) library(agreste) mon_classeur <- createWorkbook()  mes_styles <- creer_liste_style_excel()  start_ligne = 3 start_col = 2 nb_col = ncol(iris)  ajouter_tableau_excel(classeur = mon_classeur,                       tableau = iris,                       nom_feuille = \"iris\") addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$ligne_titre,          rows = start_ligne,          cols = start_col:(nb_col+start_col-1)) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 2) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 3) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 4) addStyle(wb = mon_classeur,          sheet = \"iris\",         style = mes_styles$decimal_italique,         rows = (start_ligne+1):(nrow(iris)+start_ligne),         cols = 5) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$texte,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 6) ajouter_titre_tableau(classeur = mon_classeur,                       nom_feuille = \"iris\",                       titre = \"Iris\",                       col_debut = start_col,                       format = \"chiffres_et_donnees\")  ajouter_source(classeur = mon_classeur,                nom_feuille = \"iris\",                source = \"Ceci est une source quelconque\",                format = \"chiffres_et_donnees\",                col_debut = start_col,                avec_note = FALSE)  start_ligne = 3 start_col = 2 nb_col = ncol(airquality)  ajouter_tableau_excel(classeur = mon_classeur,                       tableau = airquality,                       nom_feuille = \"airquality\")  addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$ligne_titre,          rows = start_ligne,          cols = start_col:(nb_col+start_col-1)) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 2) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 3) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 4) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 5) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 6) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 7)  ajouter_titre_tableau(classeur = mon_classeur,                       nom_feuille = \"airquality\",                       titre = \"Données qualité de l'air\",                       col_debut = 2)  ajouter_note_lecture(classeur = mon_classeur,                      nom_feuille = \"airquality\",                      note = \"blablabla\",                      col_debut = start_col) ajouter_source(classeur = mon_classeur,                nom_feuille = \"airquality\",                source = \"Eurostat\",                col_debut = start_col,                avec_note = TRUE)  saveWorkbook(wb = mon_classeur,              file = \"tableau.xlsx\",              overwrite = TRUE)  browseURL(\"tableau.xlsx\")"},{"path":"/articles/export-excel.html","id":"ajouter-le-champ","dir":"Articles","previous_headings":"Fonctions d’édition d’un classeur Excel","what":"Ajouter le champ","title":"Export excel","text":"","code":"# Création d'un classeur avec une feuille contenant iris et une feuille contenant airquality # Ajout du champ # Sauvegarde du classeur # Ouverture du classeur library(openxlsx) library(agreste) mon_classeur <- createWorkbook()  mes_styles <- creer_liste_style_excel(format = \"chiffres_et_donnees\")  start_ligne = 3 start_col = 2 nb_col = ncol(iris)  ajouter_tableau_excel(classeur = mon_classeur,                       tableau = iris,                       nom_feuille = \"iris\") addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$ligne_titre,          rows = start_ligne,          cols = start_col:(nb_col+start_col-1)) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 2) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 3) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 4) addStyle(wb = mon_classeur,          sheet = \"iris\",         style = mes_styles$decimal_italique,         rows = (start_ligne+1):(nrow(iris)+start_ligne),         cols = 5) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$texte,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 6) ajouter_titre_tableau(classeur = mon_classeur,                       nom_feuille = \"iris\",                       titre = \"Iris\",                       col_debut = start_col,                       format = \"chiffres_et_donnees\")  ajouter_source(classeur = mon_classeur,                nom_feuille = \"iris\",                source = \"Ceci est une source quelconque\",                col_debut = start_col,                avec_note = FALSE) ajouter_champ(classeur = mon_classeur,               nom_feuille = \"iris\",               champ = \"France métropolitaine\",               col_debut = start_col)  start_ligne = 3 start_col = 2 nb_col = ncol(airquality)  ajouter_tableau_excel(classeur = mon_classeur,                       tableau = airquality,                       nom_feuille = \"airquality\")  addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$ligne_titre,          rows = start_ligne,          cols = start_col:(nb_col+start_col-1)) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 2) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 3) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 4) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 5) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 6) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 7)  ajouter_titre_tableau(classeur = mon_classeur,                       nom_feuille = \"airquality\",                       titre = \"Qualité de l'air\",                       col_debut = start_col) ajouter_note_lecture(classeur = mon_classeur,                      nom_feuille = \"airquality\",                      note = \"blablabla\",                      col_debut = start_col) ajouter_source(classeur = mon_classeur,                nom_feuille = \"airquality\",                source = \"Eurostat\",                col_debut = start_col,                avec_note = TRUE) ajouter_champ(classeur = mon_classeur,               nom_feuille = \"airquality\",               champ = \"Daily air quality measurements in New York, May to September 1973.\",               col_debut = start_col)   saveWorkbook(wb = mon_classeur,              file = \"tableau.xlsx\",              overwrite = TRUE)  browseURL(\"tableau.xlsx\")"},{"path":"/articles/export-excel.html","id":"geler-des-lignes-ou-des-colonnes","dir":"Articles","previous_headings":"Fonctions d’édition d’un classeur Excel","what":"Geler des lignes ou des colonnes","title":"Export excel","text":"","code":"library(openxlsx) library(agreste)  # Création d'un classeur avec une feuille contenant iris  mon_classeur <- createWorkbook() ajouter_tableau_excel(classeur = mon_classeur, tableau = iris, nom_feuille = \"iris\", ligne_debut = 3, col_debut = 2)  # gel  geler(mon_classeur, \"iris\", ligne = 3, col = 1)  # Sauver le classeur saveWorkbook(wb = mon_classeur, file = \"tableau.xlsx\", overwrite = TRUE) # ouverture browseURL(\"tableau.xlsx\")"},{"path":"/articles/export-excel.html","id":"appliquer-une-taille-de-colonnes","dir":"Articles","previous_headings":"Fonctions d’édition d’un classeur Excel","what":"Appliquer une taille de colonnes","title":"Export excel","text":"","code":"library(openxlsx) library(agreste)  ## Création d'un classeur avec deux feuilles et deux tableaux mon_classeur <- createWorkbook()  ajouter_tableau_excel(classeur = mon_classeur,                       tableau = iris,                       nom_feuille = \"iris\",                       ligne_debut = 5,                       col_debut = 2)  ajouter_titre_tableau(classeur = mon_classeur,                       nom_feuille = \"iris\",                       titre = \"Données fleurs iris\",                       col_debut = 2,                       format = \"primeur\") ajouter_source(classeur = mon_classeur,                nom_feuille = \"iris\",                source = \"Ceci est une source quelconque\",                format = \"primeur\",                col_debut = 2,                avec_note = FALSE,                avec_titre = FALSE) ajouter_champ(classeur = mon_classeur,               nom_feuille = \"iris\",               champ = \"France métropolitaine\",               format = \"primeur\",               col_debut = 2,               avec_titre = FALSE)  ajouter_tableau_excel(classeur = mon_classeur,                       tableau = airquality,                       nom_feuille = \"airquality\",                       ligne_debut = 5,                       col_debut = 2)  ajouter_titre_tableau(classeur = mon_classeur,                       nom_feuille = \"airquality\",                       titre = \"Données qualité de l'air\",                       col_debut = 2,                       format = \"primeur\") ajouter_note_lecture(classeur = mon_classeur,                      nom_feuille = \"airquality\",                      note = \"blablabla\",                      format = \"primeur\",                      col_debut = 2,                      avec_titre = FALSE) ajouter_source(classeur = mon_classeur,                nom_feuille = \"airquality\",                source = \"Eurostat\",                format = \"primeur\",                col_debut = 2,                avec_note = TRUE,                avec_titre = FALSE) ajouter_champ(classeur = mon_classeur,               nom_feuille = \"airquality\",               champ = \"Daily air quality measurements in New York, May to September 1973.\",               format = \"primeur\",               col_debut = 2,               avec_titre = FALSE)  ajouter_titre_primeur(classeur = mon_classeur,                       titre = \"Exemple 2022\")  taille_colonnes(classeur = mon_classeur,                 liste_type_donnees = list(c(\"decimal\",                                             \"decimal\",                                             \"decimal\",                                             \"decimal\",                                             \"texte\"),                                           c(\"numerique\",                                             \"numerique\",                                             \"decimal\",                                             \"numerique\",                                             \"numerique\",                                             \"numerique\")),                 largeurs = list(c(\"auto\"), c(\"auto\")),                 format = \"primeur\",                 col_debut = 2)   ## Sauver saveWorkbook(wb = mon_classeur, file = \"tableau.xlsx\", overwrite = TRUE)  ## Ouvrir browseURL(\"tableau.xlsx\")"},{"path":"/articles/export-excel.html","id":"formater-un-classeur-automatiquement","dir":"Articles","previous_headings":"Fonctions d’édition d’un classeur Excel","what":"Formater un classeur automatiquement","title":"Export excel","text":"","code":"library(openxlsx) library(agreste)  ## Création d'un classeur avec deux feuilles et deux tableaux mon_classeur <- createWorkbook()  ajouter_tableau_excel(classeur = mon_classeur,                       tableau = iris,                       nom_feuille = \"iris\",                       ligne_debut = 5,                       col_debut = 2)  ajouter_titre_tableau(classeur = mon_classeur,                       nom_feuille = \"iris\",                       titre = \"Données fleurs iris\",                       col_debut = 2,                       format = \"primeur\") ajouter_source(classeur = mon_classeur,                nom_feuille = \"iris\",                source = \"Ceci est une source quelconque\",                format = \"primeur\",                col_debut = 2,                avec_note = FALSE,                avec_titre = FALSE) ajouter_champ(classeur = mon_classeur,               nom_feuille = \"iris\",               champ = \"France métropolitaine\",               format = \"primeur\",               col_debut = 2,               avec_titre = FALSE)  ajouter_tableau_excel(classeur = mon_classeur,                       tableau = airquality,                       nom_feuille = \"airquality\",                       ligne_debut = 5,                       col_debut = 2)  ajouter_titre_tableau(classeur = mon_classeur,                       nom_feuille = \"airquality\",                       titre = \"Données qualité de l'air\",                       col_debut = 2,                       format = \"primeur\") ajouter_note_lecture(classeur = mon_classeur,                      nom_feuille = \"airquality\",                      note = \"blablabla\",                      format = \"primeur\",                      col_debut = 2,                      avec_titre = FALSE) ajouter_source(classeur = mon_classeur,                nom_feuille = \"airquality\",                source = \"Eurostat\",                format = \"primeur\",                col_debut = 2,                avec_note = TRUE,                avec_titre = FALSE) ajouter_champ(classeur = mon_classeur,               nom_feuille = \"airquality\",               champ = \"Daily air quality measurements in New York, May to September 1973.\",               format = \"primeur\",               col_debut = 2,               avec_titre = FALSE)  ajouter_titre_primeur(classeur = mon_classeur,                       titre = \"Exemple 2022\")  taille_colonnes(classeur = mon_classeur,                 liste_type_donnees = list(c(\"decimal\",                                             \"decimal\",                                             \"decimal\",                                             \"decimal\",                                             \"texte\"),                                           c(\"numerique\",                                             \"numerique\",                                             \"decimal\",                                             \"numerique\",                                             \"numerique\",                                             \"numerique\")),                 largeurs = list(c(\"auto\"), c(\"auto\")),                 format = \"primeur\",                 col_debut = 2)  ## Formater comme un Primeur formater_auto(classeur = mon_classeur,               format = \"primeur\",               liste_feuilles_avec_note = c(\"airquality\"),               liste_type_donnees = list(c(\"decimal\",                                           \"decimal\",                                           \"decimal\",                                           \"decimal\",                                           \"texte\"),                                         c(\"numerique\",                                           \"numerique\",                                           \"decimal\",                                           \"numerique\",                                           \"numerique\",                                           \"numerique\")),                liste_lignes_titre = list(c(1), c(1)),               liste_lignes_section = list(c(5, 9),                                           c(3, 8)),               liste_lignes_sous_total = list(c(4, 8),                                              c(2, 7)),               liste_lignes_precision_1 = list(c(2,3),                                             c(0)),               liste_lignes_precision_2 = list(c(0), c(0)),               liste_lignes_precision_3 = list(c(0), c(0)),               liste_lignes_precision_4 = list(c(0), c(0)),               liste_lignes_total = list(c(150),                                         c(100)),               liste_lignes_italique = list(c(), c()),               liste_unif_unites = c(TRUE, TRUE),               liste_cellules_fusion = list(c(0), c(0)),               col_debut = 2,               avec_titre = TRUE)  ## Sauver saveWorkbook(wb = mon_classeur, file = \"tableau.xlsx\", overwrite = TRUE)  ## Ouvrir browseURL(\"tableau.xlsx\")"},{"path":"/articles/export-excel.html","id":"créer-un-tableau-excel-formaté-depuis-un-plan","dir":"Articles","previous_headings":"","what":"Créer un tableau excel formaté depuis un plan","title":"Export excel","text":"Cette fonction permet de formater un ensemble de tableaux dans un classeur Excel, en suivant un plan défini, qui indique comment formater chaque tableau : largeurs et types de colonnes, de lignes, titre, source…","code":"library(agreste) library(dplyr) library(openxlsx) library(rstudioapi) ### Import du fichier de plan plan = agreste::modele_plan  ### Création des csv  agreste::resultat_1 %>%   write.csv(file = \"resultat_1.csv\", row.names = FALSE) agreste::resultat_2 %>%   write.csv(file = \"resultat_2.csv\", row.names = FALSE) agreste::resultat_3 %>%   write.csv(file = \"resultat_3.csv\", row.names = FALSE) agreste::lait_vache %>%   write.csv(file = \"lait_vache.csv\", row.names = FALSE) agreste::scieries2020 %>%   write.csv(file = \"scieries2020.csv\", row.names = FALSE) write.xlsx(plan, \"plan.xlsx\", row.names = FALSE)  ### Formatage workbook <- creer_excel_depuis_plan(plan = \"plan.xlsx\",                                     datadir = choose.dir(),                                     format = \"chiffres_et_donnees\",                                     col_debut = 1,                                     save = TRUE,                                     path = \"document_a_envoyer.xlsx\",                                     type_virgule = \",\")"},{"path":"/articles/export-excel.html","id":"lire-un-fichier-de-nimporte-quel-type-courant","dir":"Articles","previous_headings":"","what":"Lire un fichier de n’importe quel type (courant)","title":"Export excel","text":"Permet de lire un fichier de type csv, tsv, xlsx, ods, rds, parquet, feather","code":"#' \\dontrun{ library(agreste) write.csv(iris, \"iris.csv\", row.names = FALSE, sep = \",\") df <- read_any_file(filename = \"iris.csv\", header = TRUE, sep = \",\", decimal_mark = \".\") #'}"},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Anaël Delorme. Author, maintainer. Killian Steunou. Author. MinAgri-SSP. Copyright holder.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Delorme , Steunou K (2022). agreste: Aide À La Publication Sur Agreste. R package version 1.2.0.","code":"@Manual{,   title = {agreste: Aide À La Publication Sur Agreste},   author = {Anaël Delorme and Killian Steunou},   year = {2022},   note = {R package version 1.2.0}, }"},{"path":"/index.html","id":"agreste","dir":"","previous_headings":"","what":"Aide À La Publication Sur Agreste","title":"Aide À La Publication Sur Agreste","text":"Le du package agreste est de fournir à l’ensemble des agents du SSP des outils pour faciliter la diffusion auprès du grand public. Le package agreste propose de l’aide pour construire des tableaux. Il facilite la création des documents attendus par la PAO (docx, xlsx) et apporte des modèles de Rmarkdown.","code":""},{"path":"/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Aide À La Publication Sur Agreste","text":"Vous pouvez installer le package agreste à partir du fichier agreste_1.2.0.tar.gz :","code":"remotes::install_local(\"C:/Users/killian.steunou/Downloads/chemin/agreste_1.2.0.tar.gz\")"},{"path":"/index.html","id":"utilisation","dir":"","previous_headings":"","what":"Utilisation","title":"Aide À La Publication Sur Agreste","text":"Le package agreste trois utilisations majeures : La création d’un fichier Excel contenant les différents tableaux associés à une publication, formatés automatiquement selon le type de cette dernière (chiffres et données, primeur), à partir d’un plan de formatage : creer_excel_depuis_plan() L’interface graphique intégrée qui permet de faciliter la création du fichier de plan évoqué ci-dessus : app_formatage() Ouvrir un modèle de RMarkdown, préformaté selon la publication : chiffres_et_donnees, primeur ou réponse à la demande Vous pouvez démarrer l’interface graphique en utilisant l’Addin intégré :","code":""},{"path":"/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2022 Agreste Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"/reference/agreste-package.html","id":null,"dir":"Reference","previous_headings":"","what":"agreste: Aide À La Publication Sur Agreste — agreste-package","title":"agreste: Aide À La Publication Sur Agreste — agreste-package","text":"Aide à la création des documents qui, après PAO, pourront être publiés sur Agreste. Facilite la cration de tableaux, graphiques, cartes. Automatise la création des chiffres et données.","code":""},{"path":"/reference/agreste-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"agreste: Aide À La Publication Sur Agreste — agreste-package","text":"Maintainer: Anaël Delorme anael.delorme@agriculture.gouv.fr (ORCID) Authors: Killian Steunou killian.steunou@agriculture.gouv.fr contributors: MinAgri-SSP [copyright holder]","code":""},{"path":"/reference/ajouter_champ.html","id":null,"dir":"Reference","previous_headings":"","what":"Ajouter le champ sous un tableau dans une feuille d'un fichier xlsx — ajouter_champ","title":"Ajouter le champ sous un tableau dans une feuille d'un fichier xlsx — ajouter_champ","text":"Cette fonction permet d'ajouter un champ sous un tableau dans une feuille Excel","code":""},{"path":"/reference/ajouter_champ.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ajouter le champ sous un tableau dans une feuille d'un fichier xlsx — ajouter_champ","text":"","code":"ajouter_champ(   classeur,   nom_feuille,   champ,   format = \"chiffres_et_donnees\",   col_debut = 2,   fusion = TRUE,   avec_titre = FALSE )"},{"path":"/reference/ajouter_champ.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ajouter le champ sous un tableau dans une feuille d'un fichier xlsx — ajouter_champ","text":"classeur workbook créé avec openXLSX nom_feuille nom de la feuille champ le champ à ajouter format CHAR le type de publication : \"chiffres_et_donnees\" ou \"primeur\" col_debut la colonne de départ (2eme par défaut) fusion LGL si les cellules sont à fusionner ou pas (TRUE par défaut) avec_titre LGL si le classeur est un primeur avec un titre","code":""},{"path":"/reference/ajouter_champ.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ajouter le champ sous un tableau dans une feuille d'un fichier xlsx — ajouter_champ","text":"Rien n'est renvoyé mais la feuille du classeur est modifiée","code":""},{"path":"/reference/ajouter_champ.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Ajouter le champ sous un tableau dans une feuille d'un fichier xlsx — ajouter_champ","text":"","code":"# Création d'un classeur avec une feuille contenant iris et une feuille contenant airquality # Ajout du champ # Sauvegarde du classeur # Ouverture du classeur library(openxlsx) library(agreste) mon_classeur <- createWorkbook()  mes_styles <- creer_liste_style_excel(format = \"chiffres_et_donnees\")  start_ligne = 3 start_col = 2 nb_col = ncol(iris)  ajouter_tableau_excel(classeur = mon_classeur,                       tableau = iris,                       nom_feuille = \"iris\") addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$ligne_titre,          rows = start_ligne,          cols = start_col:(nb_col+start_col-1)) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 2) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 3) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 4) addStyle(wb = mon_classeur,          sheet = \"iris\",         style = mes_styles$decimal_italique,         rows = (start_ligne+1):(nrow(iris)+start_ligne),         cols = 5) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$texte,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 6) ajouter_titre_tableau(classeur = mon_classeur,                       nom_feuille = \"iris\",                       titre = \"Iris\",                       col_debut = start_col,                       format = \"chiffres_et_donnees\")  ajouter_source(classeur = mon_classeur,                nom_feuille = \"iris\",                source = \"Ceci est une source quelconque\",                col_debut = start_col,                avec_note = FALSE) ajouter_champ(classeur = mon_classeur,               nom_feuille = \"iris\",               champ = \"France métropolitaine\",               col_debut = start_col)  start_ligne = 3 start_col = 2 nb_col = ncol(airquality)  ajouter_tableau_excel(classeur = mon_classeur,                       tableau = airquality,                       nom_feuille = \"airquality\")  addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$ligne_titre,          rows = start_ligne,          cols = start_col:(nb_col+start_col-1)) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 2) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 3) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 4) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 5) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 6) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 7)  ajouter_titre_tableau(classeur = mon_classeur,                       nom_feuille = \"airquality\",                       titre = \"Qualité de l'air\",                       col_debut = start_col) ajouter_note_lecture(classeur = mon_classeur,                      nom_feuille = \"airquality\",                      note = \"blablabla\",                      col_debut = start_col) ajouter_source(classeur = mon_classeur,                nom_feuille = \"airquality\",                source = \"Eurostat\",                col_debut = start_col,                avec_note = TRUE) ajouter_champ(classeur = mon_classeur,               nom_feuille = \"airquality\",               champ = \"Daily air quality measurements in New York, May to September 1973.\",               col_debut = start_col)   saveWorkbook(wb = mon_classeur,              file = \"tableau.xlsx\",              overwrite = TRUE)  browseURL(\"tableau.xlsx\")"},{"path":"/reference/ajouter_note_lecture.html","id":null,"dir":"Reference","previous_headings":"","what":"Ajouter une note de lecture sous un tableau dans une feuille d'un fichier xlsx — ajouter_note_lecture","title":"Ajouter une note de lecture sous un tableau dans une feuille d'un fichier xlsx — ajouter_note_lecture","text":"Cette fonction permet d'ajouter une note de lecture sous un tableau dans une feuille Excel","code":""},{"path":"/reference/ajouter_note_lecture.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ajouter une note de lecture sous un tableau dans une feuille d'un fichier xlsx — ajouter_note_lecture","text":"","code":"ajouter_note_lecture(   classeur,   nom_feuille,   note,   format = \"chiffres_et_donnees\",   col_debut = 2,   fusion = TRUE,   avec_titre = FALSE )"},{"path":"/reference/ajouter_note_lecture.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ajouter une note de lecture sous un tableau dans une feuille d'un fichier xlsx — ajouter_note_lecture","text":"classeur workbook créé avec openXLSX nom_feuille nom de la feuille note la note à écrire format CHAR le type de publication : \"chiffres_et_donnees\" ou \"primeur\" col_debut la colonne de départ (2eme par défaut) fusion LGL si les cellules sont à fusionner ou pas (TRUE par défaut) avec_titre LGL si le classeur est un primeur avec un titre","code":""},{"path":"/reference/ajouter_note_lecture.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ajouter une note de lecture sous un tableau dans une feuille d'un fichier xlsx — ajouter_note_lecture","text":"Rien n'est renvoyé mais la feuille du classeur est modifiée","code":""},{"path":"/reference/ajouter_note_lecture.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Ajouter une note de lecture sous un tableau dans une feuille d'un fichier xlsx — ajouter_note_lecture","text":"","code":"# Création d'un classeur avec une feuille contenant iris et une feuille contenant airquality # Ajout d'une note de lecture # Sauvegarde du classeur # Ouverture du classeur library(openxlsx) library(agreste) mon_classeur <- createWorkbook()  mes_styles <- creer_liste_style_excel()  start_ligne = 3 start_col = 2 nb_col = ncol(iris)  ajouter_tableau_excel(classeur = mon_classeur,                       tableau = iris,                       nom_feuille = \"iris\") addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$ligne_titre,          rows = start_ligne,          cols = start_col:(nb_col+start_col-1)) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 2) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 3) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 4) addStyle(wb = mon_classeur,          sheet = \"iris\",         style = mes_styles$decimal_italique,         rows = (start_ligne+1):(nrow(iris)+start_ligne),         cols = 5) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$texte,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 6)  ajouter_titre_tableau(classeur = mon_classeur,                       nom_feuille = \"iris\",                       titre = \"Iris\",                       col_debut = start_col,                       format = \"chiffres_et_donnees\")  ajouter_note_lecture(classeur = mon_classeur,                      nom_feuille = \"iris\",                      note = \"Ceci est une note de lecture\",                      col_debut = 2)  start_ligne = 3 start_col = 2 nb_col = ncol(airquality)  ajouter_tableau_excel(classeur = mon_classeur,                       tableau = airquality,                       nom_feuille = \"airquality\")  addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$ligne_titre,          rows = start_ligne,          cols = start_col:(nb_col+start_col-1)) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 2) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 3) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 4) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 5) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 6) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 7)  ajouter_titre_tableau(classeur = mon_classeur,                       nom_feuille = \"airquality\",                       titre = \"Données qualité de l'air\",                       col_debut = 2)  ajouter_note_lecture(classeur = mon_classeur,                      nom_feuille = \"airquality\",                      note = \"Ceci est une autre note de lecture\",                      col_debut = 2)  saveWorkbook(wb = mon_classeur, file = \"tableau.xlsx\", overwrite = TRUE)  browseURL(\"tableau.xlsx\")"},{"path":"/reference/ajouter_source.html","id":null,"dir":"Reference","previous_headings":"","what":"Ajouter la source sous un tableau dans une feuille d'un fichier xlsx — ajouter_source","title":"Ajouter la source sous un tableau dans une feuille d'un fichier xlsx — ajouter_source","text":"Cette fonction permet d'ajouter une source sous un tableau dans une feuille Excel","code":""},{"path":"/reference/ajouter_source.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ajouter la source sous un tableau dans une feuille d'un fichier xlsx — ajouter_source","text":"","code":"ajouter_source(   classeur,   nom_feuille,   source,   format = \"chiffres_et_donnees\",   col_debut = 2,   avec_note = TRUE,   fusion = TRUE,   avec_titre = FALSE )"},{"path":"/reference/ajouter_source.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ajouter la source sous un tableau dans une feuille d'un fichier xlsx — ajouter_source","text":"classeur workbook créé avec openXLSX nom_feuille nom de la feuille source la source à ajouter format CHAR le type de publication : \"chiffres_et_donnees\" ou \"primeur\" col_debut la colonne de départ (2eme par défaut) avec_note si une note de lecture est présente ou pas, par défaut TRUE fusion LGL si les cellules sont à fusionner ou pas (TRUE par défaut) avec_titre LGL si le classeur est un primeur avec un titre","code":""},{"path":"/reference/ajouter_source.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ajouter la source sous un tableau dans une feuille d'un fichier xlsx — ajouter_source","text":"Rien n'est renvoyé mais la feuille du classeur est modifiée","code":""},{"path":"/reference/ajouter_source.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Ajouter la source sous un tableau dans une feuille d'un fichier xlsx — ajouter_source","text":"","code":"# Création d'un classeur avec une feuille contenant iris et une feuille contenant airquality # Ajout de la source # Sauvegarde du classeur # Ouverture du classeur library(openxlsx) library(agreste) mon_classeur <- createWorkbook()  mes_styles <- creer_liste_style_excel()  start_ligne = 3 start_col = 2 nb_col = ncol(iris)  ajouter_tableau_excel(classeur = mon_classeur,                       tableau = iris,                       nom_feuille = \"iris\") addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$ligne_titre,          rows = start_ligne,          cols = start_col:(nb_col+start_col-1)) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 2) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 3) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 4) addStyle(wb = mon_classeur,          sheet = \"iris\",         style = mes_styles$decimal_italique,         rows = (start_ligne+1):(nrow(iris)+start_ligne),         cols = 5) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$texte,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 6) ajouter_titre_tableau(classeur = mon_classeur,                       nom_feuille = \"iris\",                       titre = \"Iris\",                       col_debut = start_col,                       format = \"chiffres_et_donnees\")  ajouter_source(classeur = mon_classeur,                nom_feuille = \"iris\",                source = \"Ceci est une source quelconque\",                format = \"chiffres_et_donnees\",                col_debut = start_col,                avec_note = FALSE)  start_ligne = 3 start_col = 2 nb_col = ncol(airquality)  ajouter_tableau_excel(classeur = mon_classeur,                       tableau = airquality,                       nom_feuille = \"airquality\")  addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$ligne_titre,          rows = start_ligne,          cols = start_col:(nb_col+start_col-1)) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 2) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 3) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 4) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 5) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 6) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 7)  ajouter_titre_tableau(classeur = mon_classeur,                       nom_feuille = \"airquality\",                       titre = \"Données qualité de l'air\",                       col_debut = 2)  ajouter_note_lecture(classeur = mon_classeur,                      nom_feuille = \"airquality\",                      note = \"blablabla\",                      col_debut = start_col) ajouter_source(classeur = mon_classeur,                nom_feuille = \"airquality\",                source = \"Eurostat\",                col_debut = start_col,                avec_note = TRUE)  saveWorkbook(wb = mon_classeur,              file = \"tableau.xlsx\",              overwrite = TRUE)  browseURL(\"tableau.xlsx\")"},{"path":"/reference/ajouter_tableau_excel.html","id":null,"dir":"Reference","previous_headings":"","what":"Ajouter un tableau dans une feuille excel — ajouter_tableau_excel","title":"Ajouter un tableau dans une feuille excel — ajouter_tableau_excel","text":"Cette fonction crée une nouvelle feuille dans le classeur passé en paramètre et y insère un tableau mis en forme.","code":""},{"path":"/reference/ajouter_tableau_excel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ajouter un tableau dans une feuille excel — ajouter_tableau_excel","text":"","code":"ajouter_tableau_excel(   classeur,   tableau,   nom_feuille,   ligne_debut = 3,   col_debut = 2 )"},{"path":"/reference/ajouter_tableau_excel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ajouter un tableau dans une feuille excel — ajouter_tableau_excel","text":"classeur workbook créé avec openXLSX tableau dataframe ou tibble à insérer dans une nouvelle feuille nom_feuille nom de la nouvelle feuille ligne_debut la ligne à laquelle démarre le tableau col_debut la colonne à laquelle démarre le tableau","code":""},{"path":"/reference/ajouter_tableau_excel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ajouter un tableau dans une feuille excel — ajouter_tableau_excel","text":"Rien n'est renvoyé mais l'objet classeur une nouvelle feuille","code":""},{"path":"/reference/ajouter_tableau_excel.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Ajouter un tableau dans une feuille excel — ajouter_tableau_excel","text":"","code":"# Création d'un classeur avec une feuille contenant iris et une feuille contenant airquality # Sauvegarde du classeur # Ouverture du classeur library(openxlsx) library(agreste) mon_classeur <- createWorkbook()  mes_styles <- creer_liste_style_excel()  start_ligne = 3 start_col = 2 nb_col = ncol(iris)  ajouter_tableau_excel(classeur = mon_classeur, tableau = iris, nom_feuille = \"iris\") addStyle(wb = mon_classeur, sheet = \"iris\", style = mes_styles$ligne_titre, rows = start_ligne, cols = start_col:(nb_col+start_col-1)) addStyle(wb = mon_classeur, sheet = \"iris\", style = mes_styles$decimal, rows = (start_ligne+1):(nrow(iris)+start_ligne), cols = 2) addStyle(wb = mon_classeur, sheet = \"iris\", style = mes_styles$decimal, rows = (start_ligne+1):(nrow(iris)+start_ligne), cols = 3) addStyle(wb = mon_classeur, sheet = \"iris\", style = mes_styles$decimal, rows = (start_ligne+1):(nrow(iris)+start_ligne), cols = 4) addStyle(wb = mon_classeur, sheet = \"iris\", style = mes_styles$decimal_italique, rows = (start_ligne+1):(nrow(iris)+start_ligne), cols = 5) addStyle(wb = mon_classeur, sheet = \"iris\", style = mes_styles$texte, rows = (start_ligne+1):(nrow(iris)+start_ligne), cols = 6)  start_ligne = 3 start_col = 2 nb_col = ncol(airquality)  ajouter_tableau_excel(classeur = mon_classeur, tableau = airquality, nom_feuille = \"airquality\") addStyle(wb = mon_classeur, sheet = \"airquality\", style = mes_styles$ligne_titre, rows = start_ligne, cols = start_col:(nb_col+start_col-1)) addStyle(wb = mon_classeur, sheet = \"airquality\", style = mes_styles$numerique, rows = (start_ligne+1):(nrow(airquality)+start_ligne), cols = 2) addStyle(wb = mon_classeur, sheet = \"airquality\", style = mes_styles$numerique, rows = (start_ligne+1):(nrow(airquality)+start_ligne), cols = 3) addStyle(wb = mon_classeur, sheet = \"airquality\", style = mes_styles$decimal, rows = (start_ligne+1):(nrow(airquality)+start_ligne), cols = 4) addStyle(wb = mon_classeur, sheet = \"airquality\", style = mes_styles$numerique, rows = (start_ligne+1):(nrow(airquality)+start_ligne), cols = 5) addStyle(wb = mon_classeur, sheet = \"airquality\", style = mes_styles$numerique, rows = (start_ligne+1):(nrow(airquality)+start_ligne), cols = 6) addStyle(wb = mon_classeur, sheet = \"airquality\", style = mes_styles$numerique, rows = (start_ligne+1):(nrow(airquality)+start_ligne), cols = 7)  saveWorkbook(wb = mon_classeur, file = \"tableau.xlsx\", overwrite = TRUE)  browseURL(\"tableau.xlsx\")"},{"path":"/reference/ajouter_titre_primeur.html","id":null,"dir":"Reference","previous_headings":"","what":"Ajouter le titre du primeur dans la première cellule de chaque feuille — ajouter_titre_primeur","title":"Ajouter le titre du primeur dans la première cellule de chaque feuille — ajouter_titre_primeur","text":"Cette fonction permet d'ajouter le titre en haut de chaque feuille d'un classeur de type primeur","code":""},{"path":"/reference/ajouter_titre_primeur.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ajouter le titre du primeur dans la première cellule de chaque feuille — ajouter_titre_primeur","text":"","code":"ajouter_titre_primeur(classeur, titre, col_debut = 2, fusion = TRUE)"},{"path":"/reference/ajouter_titre_primeur.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ajouter le titre du primeur dans la première cellule de chaque feuille — ajouter_titre_primeur","text":"classeur workbook créé avec openXLSX titre le titre à ajouter col_debut la colonne de départ (2eme par défaut) fusion LGL si les cellules sont à fusionner ou pas (TRUE par défaut)","code":""},{"path":"/reference/ajouter_titre_primeur.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ajouter le titre du primeur dans la première cellule de chaque feuille — ajouter_titre_primeur","text":"Rien n'est renvoyé mais la feuille du classeur est modifiée","code":""},{"path":"/reference/ajouter_titre_primeur.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Ajouter le titre du primeur dans la première cellule de chaque feuille — ajouter_titre_primeur","text":"","code":"library(openxlsx) library(agreste) mon_classeur <- createWorkbook()  mes_styles <- creer_liste_style_excel(format = \"primeur\")  start_ligne = 5 start_col = 2 nb_col = ncol(iris)  ajouter_tableau_excel(classeur = mon_classeur,                       tableau = iris,                       nom_feuille = \"iris\",                       ligne_debut = 5)  ## Formatage  addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$ligne_titre,          rows = start_ligne,          cols = start_col:(nb_col+start_col-1)) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 2) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 3) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 4) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$decimal_italique,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 5) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$texte,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 6)  ## Ajout du titre   ajouter_titre_primeur(classeur = mon_classeur,                       titre = \"Iris\")  ## Sauvegarde saveWorkbook(wb = mon_classeur,              file = \"tableau.xlsx\",              overwrite = TRUE)  browseURL(\"tableau.xlsx\")"},{"path":"/reference/ajouter_titre_tableau.html","id":null,"dir":"Reference","previous_headings":"","what":"Ajouter le titre du tableau dans la première cellule d'une feuille — ajouter_titre_tableau","title":"Ajouter le titre du tableau dans la première cellule d'une feuille — ajouter_titre_tableau","text":"Cette fonction permet d'ajouter un titre dans la cellule A1 d'une feuille","code":""},{"path":"/reference/ajouter_titre_tableau.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ajouter le titre du tableau dans la première cellule d'une feuille — ajouter_titre_tableau","text":"","code":"ajouter_titre_tableau(   classeur,   nom_feuille,   titre,   col_debut = 2,   format = \"chiffres_et_donnees\",   fusion = TRUE )"},{"path":"/reference/ajouter_titre_tableau.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Ajouter le titre du tableau dans la première cellule d'une feuille — ajouter_titre_tableau","text":"classeur workbook créé avec openXLSX nom_feuille nom de la feuille titre le titre à ajouter col_debut la colonne de départ (2eme par défaut) format CHAR le type de publication : \"chiffres_et_donnees\" ou \"primeur\" fusion LGL si les cellules sont à fusionner ou pas (TRUE par défaut)","code":""},{"path":"/reference/ajouter_titre_tableau.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ajouter le titre du tableau dans la première cellule d'une feuille — ajouter_titre_tableau","text":"Rien n'est renvoyé mais la feuille du classeur est modifiée","code":""},{"path":"/reference/ajouter_titre_tableau.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Ajouter le titre du tableau dans la première cellule d'une feuille — ajouter_titre_tableau","text":"","code":"library(openxlsx) library(agreste)  ## Création d'un classeur  mon_classeur <- createWorkbook()  mes_styles <- creer_liste_style_excel(format = \"chiffres_et_donnees\")  start_ligne = 3 start_col = 2 nb_col = ncol(iris)  ajouter_tableau_excel(classeur = mon_classeur,                       tableau = iris,                       nom_feuille = \"iris\")  ## Formatage  addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$ligne_titre,          rows = start_ligne,          cols = start_col:(nb_col+start_col-1)) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 2) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 3) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 4) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$decimal_italique,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 5) addStyle(wb = mon_classeur,          sheet = \"iris\",          style = mes_styles$texte,          rows = (start_ligne+1):(nrow(iris)+start_ligne),          cols = 6)  ## Ajout du titre   ajouter_titre_tableau(classeur = mon_classeur,                       nom_feuille = \"iris\",                       titre = \"Données fleurs iris\",                       col_debut = 2,                       format = \"chiffres_et_donnees\")  ## Deuxième feuille  start_ligne = 3 start_col = 2 nb_col = ncol(airquality)  ajouter_tableau_excel(classeur = mon_classeur,                       tableau = airquality,                       nom_feuille = \"airquality\")  addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$ligne_titre,          rows = start_ligne,          cols = start_col:(nb_col+start_col-1)) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 2) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 3) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$decimal,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 4) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 5) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 6) addStyle(wb = mon_classeur,          sheet = \"airquality\",          style = mes_styles$numerique,          rows = (start_ligne+1):(nrow(airquality)+start_ligne),          cols = 7)  ajouter_titre_tableau(classeur = mon_classeur,                       nom_feuille = \"airquality\",                       titre = \"Données qualité de l'air\",                       col_debut = 2)  saveWorkbook(wb = mon_classeur,              file = \"tableau.xlsx\",              overwrite = TRUE)  browseURL(\"tableau.xlsx\")"},{"path":"/reference/app_formatage.html","id":null,"dir":"Reference","previous_headings":"","what":"Ouvrir l'application Shiny d'édition du tableur — app_formatage","title":"Ouvrir l'application Shiny d'édition du tableur — app_formatage","text":"Cette fonction permet d'ouvrir l'interface graphique s'appuyant sur les fonctions de formatage du package pour éditer des tableaux plus rapidement","code":""},{"path":"/reference/app_formatage.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ouvrir l'application Shiny d'édition du tableur — app_formatage","text":"","code":"app_formatage()"},{"path":"/reference/app_formatage.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Ouvrir l'application Shiny d'édition du tableur — app_formatage","text":"Rien n'est renvoyé, l'appli s'ouvre.","code":""},{"path":"/reference/app_formatage.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Ouvrir l'application Shiny d'édition du tableur — app_formatage","text":"","code":"library(agreste) if (FALSE) { app_formatage() }"},{"path":"/reference/carte_aplat.html","id":null,"dir":"Reference","previous_headings":"","what":"Créer une carte représentant les volumes en aplat de couleurs — carte_aplat","title":"Créer une carte représentant les volumes en aplat de couleurs — carte_aplat","text":"Créer une carte représentant les volumes en aplat de couleurs","code":""},{"path":"/reference/carte_aplat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Créer une carte représentant les volumes en aplat de couleurs — carte_aplat","text":"","code":"carte_aplat(   df,   colonne_code_zone_geo,   colonne_volume,   titre_carte = \"Carte 1\",   sous_titre_carte = \"sous titre de la carte\",   titre_legende_volume = \"titre de la legende\",   note_sous_carte = \"Source : Agreste\",   legend.position = \"right\",   zone_geographique = \"france\",   niveau_representation = \"region_metro\",   couleur_fond_carte = \"white\",   couleur_limite_zone = \"black\",   taille_limite_zone = 0.3,   couleur_max = \"#E66A64\",   couleur_min = \"white\",   hauteur_cm = 8,   largeur_cm = 8,   save_carte = FALSE,   path_carte = \"carte.png\" )"},{"path":"/reference/carte_aplat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Créer une carte représentant les volumes en aplat de couleurs — carte_aplat","text":"df dataframe avec les données à afficher sur la carte colonne_code_zone_geo nom de la colonne contenant les id de la zone géo : code région, n° de département... colonne_volume nom de la colonne contenant les données de volume titre_carte CHAR Titre à afficher en haut de la carte sous_titre_carte CHAR Sous-titre à afficher en haut de la carte, en dessous du titre titre_legende_volume CHAR Titre à afficher en haut de la légende note_sous_carte CHAR Note à afficher sous la carte legend.position CHAR choit de la position de la carte \"right\", \"left\", \"bottom\", \"top\" zone_geographique CHAR indiquant la zone retenue pour la carte : \"france\", \"ue\" ou \"monde\" niveau_representation CHAR indiquant le niveau de représentation : \"pays\", \"region_metro\" ou \"departement_metro\" couleur_fond_carte CHAR couleur de fond la carte \"nom_couleur\" ou \"#code_couleur_html\" couleur_limite_zone CHAR couleur des lignes de séparation de zone géographique \"nom_couleur\" ou \"#code_couleur_html\" taille_limite_zone NUM épaisseur des lignes de séparation de zone géographique couleur_max CHAR couleur à utiliser pour la plus haute valeur de nuance de l'aplat \"nom_couleur\" ou \"#code_couleur_html\" couleur_min CHAR couleur à utiliser pour la plus basse valeur de nuance de l'aplat \"nom_couleur\" ou \"#code_couleur_html\" hauteur_cm NUM hauteur de la carte en cm largeur_cm NUM largeur de la carte en cm save_carte LGL TRUE si export de la carte au format png, FALSE par défaut (simple plot de la carte) path_carte CHAR chemin vers l'image à sauvegarder","code":""},{"path":"/reference/carte_aplat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Créer une carte représentant les volumes en aplat de couleurs — carte_aplat","text":"une carte de type ggplot 2","code":""},{"path":"/reference/carte_aplat.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Créer une carte représentant les volumes en aplat de couleurs — carte_aplat","text":"","code":"library(agreste) library(dplyr) ### récupération des données de permis de construire de SITADEL  permis_construire_region_2020 <- agreste::permis_construire_region %>%    filter(annee_autorisation == 2020)  ### création de la carte et plot carte_pc_2020 <- carte_aplat(df = permis_construire_region_2020, colonne_code_zone_geo = REG, colonne_volume = PC, titre_carte = \"Carte 1\", sous_titre_carte = \"Nombre de permis de construire délivré en 2020 par région\", titre_legende_volume = \"Nombre de permis de construire\", save_carte = FALSE)"},{"path":"/reference/carte_rond_proportionnel.html","id":null,"dir":"Reference","previous_headings":"","what":"Créer une carte représentant les volumes en ronds proportionnels — carte_rond_proportionnel","title":"Créer une carte représentant les volumes en ronds proportionnels — carte_rond_proportionnel","text":"Créer une carte représentant les volumes en ronds proportionnels","code":""},{"path":"/reference/carte_rond_proportionnel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Créer une carte représentant les volumes en ronds proportionnels — carte_rond_proportionnel","text":"","code":"carte_rond_proportionnel(   df,   colonne_code_zone_geo,   colonne_volume,   titre_carte = \"Carte 1\",   sous_titre_carte = \"sous titre de la carte\",   titre_legende_volume = \"titre de la legende\",   note_sous_carte = \"Lecture : bla bla bla <br> <br> Source : Agreste\",   legend.position = \"right\",   zone_geographique = \"france\",   niveau_representation = \"region_metro\",   couleur_fond_carte = \"white\",   couleur_limite_zone = \"black\",   taille_limite_zone = 0.3,   couleur_fond_rond = \"#E66A64\",   couleur_contour_rond = \"darkgray\",   taille_max_rond = 9,   hauteur_cm = 8,   largeur_cm = 8,   save_carte = FALSE,   path_carte = \"carte.png\" )"},{"path":"/reference/carte_rond_proportionnel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Créer une carte représentant les volumes en ronds proportionnels — carte_rond_proportionnel","text":"df dataframe avec les données à afficher sur la carte colonne_code_zone_geo nom de la colonne contenant les id de la zone géo : code région, n° de département... colonne_volume nom de la colonne contenant les données de volume titre_carte CHAR Titre à afficher en haut de la carte sous_titre_carte CHAR Sous-titre à afficher en haut de la carte, en dessous du titre titre_legende_volume CHAR Titre à afficher en haut de la légende note_sous_carte CHAR Note à afficher sous la carte legend.position CHAR choit de la position de la carte \"right\", \"left\", \"bottom\", \"top\" zone_geographique CHAR indiquant la zone retenue pour la carte : \"france\", \"ue\" ou \"monde\" niveau_representation CHAR indiquant le niveau de représentation : \"pays\", \"region_metro\" ou \"departement_metro\" couleur_fond_carte CHAR couleur de fond la carte \"nom_couleur\" ou \"#code_couleur_html\" couleur_limite_zone CHAR couleur des lignes de séparation de zone géographique \"nom_couleur\" ou \"#code_couleur_html\" taille_limite_zone NUM épaisseur des lignes de séparation de zone géographique couleur_fond_rond CHAR couleur de remplissage des ronds affichés \"nom_couleur\" ou \"#code_couleur_html\" couleur_contour_rond CHAR couleur de contour des ronds \"nom_couleur\" ou \"#code_couleur_html\" taille_max_rond NUM taille du rond correspondant au plus grand volume hauteur_cm NUM hauteur de la carte en cm largeur_cm NUM largeur de la carte en cm save_carte LGL TRUE si export de la carte au format png, FALSE par défaut (simple plot de la carte) path_carte CHAR chemin vers l'image à sauvegarder","code":""},{"path":"/reference/carte_rond_proportionnel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Créer une carte représentant les volumes en ronds proportionnels — carte_rond_proportionnel","text":"une carte de type ggplot 2","code":""},{"path":"/reference/carte_rond_proportionnel.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Créer une carte représentant les volumes en ronds proportionnels — carte_rond_proportionnel","text":"","code":"library(agreste) library(dplyr) ### récupération des données de permis de construire de SITADEL  permis_construire_region_2020 <- agreste::permis_construire_region %>%    filter(annee_autorisation == 2020)  ### création de la carte et sauvegarde du fichier carte carte_pc_2020 <- carte_rond_proportionnel(df = permis_construire_region_2020, colonne_code_zone_geo = REG, colonne_volume = PC, titre_carte = \"Carte 1\", sous_titre_carte = \"Nombre de permis de construire délivré en 2020 par région\", titre_legende_volume = \"Nombre de permis de construire\", save_carte = TRUE, path_carte = \"carteReg.png\")  ### ouverture de la carte browseURL(\"carteReg.png\")  # Pour faire par département : permis_construire_dep_2020 <- agreste::permis_construire_dep %>%   filter(annee_autorisation == 2020)  carte_pc_2020 <- carte_rond_proportionnel(df = permis_construire_dep_2020, colonne_code_zone_geo = DEP, colonne_volume = PC, niveau_representation = \"departement_metro\", titre_carte = \"Carte 2\", sous_titre_carte = \"Nombre de permis de construire délivré en 2020 par département\", titre_legende_volume = \"Nombre de permis de construire\", save_carte = TRUE, path_carte = \"carteDEP.png\", taille_max_rond = 3)  browseURL(\"carteDEP.png\")"},{"path":"/reference/creer_excel_depuis_plan.html","id":null,"dir":"Reference","previous_headings":"","what":"Crée un classeur et le formate — creer_excel_depuis_plan","title":"Crée un classeur et le formate — creer_excel_depuis_plan","text":"Cette fonction permet de formater tous les tableaux d'un classeur selon le type de publication choisi, simplement à partir d'un plan. Les fichiers indiqués dans le plan doivent être dans le répertoire de travail.","code":""},{"path":"/reference/creer_excel_depuis_plan.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Crée un classeur et le formate — creer_excel_depuis_plan","text":"","code":"creer_excel_depuis_plan(   plan,   format,   col_debut = NULL,   datadir = NULL,   sep = \",\",   type_virgule = \",\",   save = TRUE,   path = \"tableau1.xlsx\",   utiliser_largeur_max = TRUE )"},{"path":"/reference/creer_excel_depuis_plan.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Crée un classeur et le formate — creer_excel_depuis_plan","text":"plan fichier .xlsx ou data frame contenant les détails pour chaque tableau format CHAR le type de publication : \"chiffres_et_donnees\" ou \"primeur\" col_debut NUM la colonne à laquelle les tableaux démarrent, NULL pour automatiquement déterminée selon le format datadir CHAR le chemin vers le dossier contenant les données. Dossier de travail actif si non spécifié. sep CHAR le caractère utilisé pour séparer les colonnes des fichiers type_virgule CHAR le type de séparation décimale utilisée : \".\" ou \",\" save LGL TRUE si export du classeur au format xlsx path CHAR chemin vers le tableau à sauvegarder largeur_max LGL si le classeur doit respecter la largeur maximale des règles de diffusion (83 pour un chiffres et données)","code":""},{"path":"/reference/creer_excel_depuis_plan.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Crée un classeur et le formate — creer_excel_depuis_plan","text":"un objet de type workbook formaté","code":""},{"path":"/reference/creer_excel_depuis_plan.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Crée un classeur et le formate — creer_excel_depuis_plan","text":"","code":"library(agreste) library(dplyr) library(openxlsx) library(rstudioapi) ### Import du fichier de plan plan = agreste::modele_plan  ### Création des csv  agreste::resultat_1 %>%   write.csv(file = \"resultat_1.csv\", row.names = FALSE) agreste::resultat_2 %>%   write.csv(file = \"resultat_2.csv\", row.names = FALSE) agreste::resultat_3 %>%   write.csv(file = \"resultat_3.csv\", row.names = FALSE) agreste::lait_vache %>%   write.csv(file = \"lait_vache.csv\", row.names = FALSE) agreste::scieries2020 %>%   write.csv(file = \"scieries2020.csv\", row.names = FALSE) write.xlsx(plan, \"plan.xlsx\", row.names = FALSE)  ### Formatage workbook <- creer_excel_depuis_plan(plan = \"plan.xlsx\",                                     datadir = choose.dir(),                                     format = \"chiffres_et_donnees\",                                     col_debut = 1,                                     save = TRUE,                                     path = \"document_a_envoyer.xlsx\",                                     type_virgule = \",\")"},{"path":"/reference/creer_liste_style_excel.html","id":null,"dir":"Reference","previous_headings":"","what":"Parametrer le tableur excel — creer_liste_style_excel","title":"Parametrer le tableur excel — creer_liste_style_excel","text":"Cette fonction permet de créer une liste avec tous les styles utiles aux publications Agreste xlsx","code":""},{"path":"/reference/creer_liste_style_excel.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Parametrer le tableur excel — creer_liste_style_excel","text":"","code":"creer_liste_style_excel(format = \"chiffres_et_donnees\")"},{"path":"/reference/creer_liste_style_excel.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Parametrer le tableur excel — creer_liste_style_excel","text":"format le format choisi : \"chiffres_et_donnees\" ou \"primeur\"","code":""},{"path":"/reference/creer_liste_style_excel.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Parametrer le tableur excel — creer_liste_style_excel","text":"une liste avec tous les styles disponibles (objets openxls)","code":""},{"path":"/reference/creer_liste_style_excel.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Parametrer le tableur excel — creer_liste_style_excel","text":"","code":"library(agreste) mes_styles <- creer_liste_style_excel(format = \"chiffres_et_donnees\")  #exemples mes_styles$ligne_titre mes_styles$numerique"},{"path":"/reference/donnees_fond_carte.html","id":null,"dir":"Reference","previous_headings":"","what":"Créer un tableau avec les données géographiques de fond de carte — donnees_fond_carte","title":"Créer un tableau avec les données géographiques de fond de carte — donnees_fond_carte","text":"Créer un tableau avec les données géographiques de fond de carte","code":""},{"path":"/reference/donnees_fond_carte.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Créer un tableau avec les données géographiques de fond de carte — donnees_fond_carte","text":"","code":"donnees_fond_carte(   zone_geographique = \"france\",   niveau_representation = \"region_metro\" )"},{"path":"/reference/donnees_fond_carte.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Créer un tableau avec les données géographiques de fond de carte — donnees_fond_carte","text":"zone_geographique CHAR indiquant la zone retenue pour la carte : \"france\", \"ue\" ou \"monde\" niveau_representation CHAR indiquant le niveau de représentation : \"pays\", \"region_metro\" ou \"departement_metro\"","code":""},{"path":"/reference/donnees_fond_carte.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Créer un tableau avec les données géographiques de fond de carte — donnees_fond_carte","text":"Dataframe avec les données géographiques des zones de la carte","code":""},{"path":"/reference/donnees_fond_carte.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Créer un tableau avec les données géographiques de fond de carte — donnees_fond_carte","text":"","code":"data_geo_france_region_metro <- donnees_fond_carte(zone_geographique = \"france\", niveau_representation = \"region_metro\") data_geo_france_dep_metro <- donnees_fond_carte(zone_geographique = \"france\", niveau_representation = \"departement_metro\")"},{"path":"/reference/formater_auto.html","id":null,"dir":"Reference","previous_headings":"","what":"Formater un classeur entier — formater_auto","title":"Formater un classeur entier — formater_auto","text":"Cette fonction permet de formater tous les tableaux d'un classeur selon le type de publication choisi","code":""},{"path":"/reference/formater_auto.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Formater un classeur entier — formater_auto","text":"","code":"formater_auto(   classeur,   format,   liste_feuilles_avec_note,   liste_type_donnees,   liste_lignes_titre,   liste_lignes_section,   liste_lignes_sous_total,   liste_lignes_precision_1,   liste_lignes_precision_2,   liste_lignes_precision_3,   liste_lignes_precision_4,   liste_lignes_total,   liste_lignes_italique,   liste_unif_unites,   liste_cellules_fusion,   col_debut = 2,   avec_titre = FALSE )"},{"path":"/reference/formater_auto.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Formater un classeur entier — formater_auto","text":"classeur workbook créé avec openXLSX format CHAR le type de publication : \"chiffres_et_donnees\" ou \"primeur\" liste_feuilles_avec_note vecteur contenant le nom de chaque feuille avec une note de lecture liste_type_donnees LIST liste de vecteurs contenant les types de données de chaque colonne liste_lignes_titre LIST liste des lignes de titres de colonnes liste_lignes_section LIST liste de vecteurs contenant les numéros des lignes du tableau qui sont des sections liste_lignes_sous_total LIST liste des vecteurs contenant les numéros des lignes du tableau qui sont des sous-totaux liste_lignes_precision_1 LIST liste des vecteurs contenant les numéros des lignes du tableau qui sont des lignes de précision de niveau 1 liste_lignes_precision_2 LIST liste des vecteurs contenant les numéros des lignes du tableau qui sont des lignes de précision de niveau 2 liste_lignes_precision_3 LIST liste des vecteurs contenant les numéros des lignes du tableau qui sont des lignes de précision de niveau 3 liste_lignes_precision_4 LIST liste des vecteurs contenant les numéros des lignes du tableau qui sont des lignes de précision de niveau 4 liste_lignes_total LIST liste des vecteurs contenant les numéros des lignes du tableau qui sont des lignes de totaux liste_unif_unites VEC un vecteur de valeurs logiques pour indiquer les feuilles ayant des unités de colonnes différentes liste_cellules_fusion LIST la liste des cellules à fusionner col_debut NUM la colonne à laquelle les tableaux démarrent avec_titre LGL si le classeur est un primeur avec un titre","code":""},{"path":"/reference/formater_auto.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Formater un classeur entier — formater_auto","text":"Rien n'est renvoyé mais le classeur est modifié","code":""},{"path":"/reference/formater_auto.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Formater un classeur entier — formater_auto","text":"","code":"library(openxlsx) library(agreste)  ## Création d'un classeur avec deux feuilles et deux tableaux mon_classeur <- createWorkbook()  ajouter_tableau_excel(classeur = mon_classeur,                       tableau = iris,                       nom_feuille = \"iris\",                       ligne_debut = 5,                       col_debut = 2)  ajouter_titre_tableau(classeur = mon_classeur,                       nom_feuille = \"iris\",                       titre = \"Données fleurs iris\",                       col_debut = 2,                       format = \"primeur\") ajouter_source(classeur = mon_classeur,                nom_feuille = \"iris\",                source = \"Ceci est une source quelconque\",                format = \"primeur\",                col_debut = 2,                avec_note = FALSE,                avec_titre = FALSE) ajouter_champ(classeur = mon_classeur,               nom_feuille = \"iris\",               champ = \"France métropolitaine\",               format = \"primeur\",               col_debut = 2,               avec_titre = FALSE)  ajouter_tableau_excel(classeur = mon_classeur,                       tableau = airquality,                       nom_feuille = \"airquality\",                       ligne_debut = 5,                       col_debut = 2)  ajouter_titre_tableau(classeur = mon_classeur,                       nom_feuille = \"airquality\",                       titre = \"Données qualité de l'air\",                       col_debut = 2,                       format = \"primeur\") ajouter_note_lecture(classeur = mon_classeur,                      nom_feuille = \"airquality\",                      note = \"blablabla\",                      format = \"primeur\",                      col_debut = 2,                      avec_titre = FALSE) ajouter_source(classeur = mon_classeur,                nom_feuille = \"airquality\",                source = \"Eurostat\",                format = \"primeur\",                col_debut = 2,                avec_note = TRUE,                avec_titre = FALSE) ajouter_champ(classeur = mon_classeur,               nom_feuille = \"airquality\",               champ = \"Daily air quality measurements in New York, May to September 1973.\",               format = \"primeur\",               col_debut = 2,               avec_titre = FALSE)  ajouter_titre_primeur(classeur = mon_classeur,                       titre = \"Exemple 2022\")  taille_colonnes(classeur = mon_classeur,                 liste_type_donnees = list(c(\"decimal\",                                             \"decimal\",                                             \"decimal\",                                             \"decimal\",                                             \"texte\"),                                           c(\"numerique\",                                             \"numerique\",                                             \"decimal\",                                             \"numerique\",                                             \"numerique\",                                             \"numerique\")),                 largeurs = list(c(\"auto\"), c(\"auto\")),                 format = \"primeur\",                 col_debut = 2)  ## Formater comme un Primeur formater_auto(classeur = mon_classeur,               format = \"primeur\",               liste_feuilles_avec_note = c(\"airquality\"),               liste_type_donnees = list(c(\"decimal\",                                           \"decimal\",                                           \"decimal\",                                           \"decimal\",                                           \"texte\"),                                         c(\"numerique\",                                           \"numerique\",                                           \"decimal\",                                           \"numerique\",                                           \"numerique\",                                           \"numerique\")),                liste_lignes_titre = list(c(1), c(1)),               liste_lignes_section = list(c(5, 9),                                           c(3, 8)),               liste_lignes_sous_total = list(c(4, 8),                                              c(2, 7)),               liste_lignes_precision_1 = list(c(2,3),                                             c(0)),               liste_lignes_precision_2 = list(c(0), c(0)),               liste_lignes_precision_3 = list(c(0), c(0)),               liste_lignes_precision_4 = list(c(0), c(0)),               liste_lignes_total = list(c(150),                                         c(100)),               liste_lignes_italique = list(c(), c()),               liste_unif_unites = c(TRUE, TRUE),               liste_cellules_fusion = list(c(0), c(0)),               col_debut = 2,               avec_titre = TRUE)  ## Sauver saveWorkbook(wb = mon_classeur, file = \"tableau.xlsx\", overwrite = TRUE)  ## Ouvrir browseURL(\"tableau.xlsx\")"},{"path":"/reference/geler.html","id":null,"dir":"Reference","previous_headings":"","what":"Geler une(des) ligne(s) et/ou une(des) colonne(s) — geler","title":"Geler une(des) ligne(s) et/ou une(des) colonne(s) — geler","text":"Cette fonction permet de geler une ou plusieurs lignes ainsi qu'une ou plusieurs colonnes d'une feuille de classeur","code":""},{"path":"/reference/geler.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Geler une(des) ligne(s) et/ou une(des) colonne(s) — geler","text":"","code":"geler(classeur, nom_feuille, ligne = 0, col = 0)"},{"path":"/reference/geler.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Geler une(des) ligne(s) et/ou une(des) colonne(s) — geler","text":"classeur workbook créé avec openXLSX nom_feuille nom de la feuille ligne la ligne à geler (0 si pas de ligne à geler) col la colonne à geler (0 si pas de colonne à geler)","code":""},{"path":"/reference/geler.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Geler une(des) ligne(s) et/ou une(des) colonne(s) — geler","text":"Rien n'est renvoyé mais la feuille du classeur est modifiée","code":""},{"path":"/reference/geler.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Geler une(des) ligne(s) et/ou une(des) colonne(s) — geler","text":"","code":"library(openxlsx) library(agreste)  # Création d'un classeur avec une feuille contenant iris  mon_classeur <- createWorkbook() ajouter_tableau_excel(classeur = mon_classeur, tableau = iris, nom_feuille = \"iris\", ligne_debut = 3, col_debut = 2)  # gel  geler(mon_classeur, \"iris\", ligne = 3, col = 1)  # Sauver le classeur saveWorkbook(wb = mon_classeur, file = \"tableau.xlsx\", overwrite = TRUE) # ouverture browseURL(\"tableau.xlsx\")"},{"path":"/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe operator — %>%","text":"lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"result calling rhs(lhs).","code":""},{"path":"/reference/read_any_file.html","id":null,"dir":"Reference","previous_headings":"","what":"Lit un fichier — read_any_file","title":"Lit un fichier — read_any_file","text":"Prend en charge les fichiers csv, xlsx, rds","code":""},{"path":"/reference/read_any_file.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Lit un fichier — read_any_file","text":"","code":"read_any_file(   filename,   header = TRUE,   sep = \",\",   decimal_mark = \".\",   sheet = 1 )"},{"path":"/reference/read_any_file.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Lit un fichier — read_any_file","text":"filename CHAR le nom du fichier, extension incluse","code":""},{"path":"/reference/read_any_file.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Lit un fichier — read_any_file","text":"dataframe","code":""},{"path":[]},{"path":"/reference/taille_colonnes.html","id":null,"dir":"Reference","previous_headings":"","what":"Applique des tailles de colonne aux tableaux d'un workbook — taille_colonnes","title":"Applique des tailles de colonne aux tableaux d'un workbook — taille_colonnes","text":"Cette fonction permet d'appliquer une taille de colonne choisie par l'utilisateur ou bien automatiquement, le total étant égal à 83, et les colonnes de texte étant plus larges que les autres en mode automatique","code":""},{"path":"/reference/taille_colonnes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Applique des tailles de colonne aux tableaux d'un workbook — taille_colonnes","text":"","code":"taille_colonnes(   classeur,   liste_type_donnees,   largeurs,   format,   col_debut = 1,   largeur_max = TRUE )"},{"path":"/reference/taille_colonnes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Applique des tailles de colonne aux tableaux d'un workbook — taille_colonnes","text":"classeur Le classeur excel, objet de type workbook liste_type_donnees LIST liste de vecteurs contenant les types de données de chaque colonne largeurs LIST liste de vecteurs contenant les largeurs colonne, \"auto\" pour appliquer des largeurs automatique format CHAR le format de publication : \"primeur\" ou \"chiffres_et_donnees\" col_debut La colonne à laquelle commencent les tableaux, par défaut 1 largeur_max LGL si le classeur doit respecter la largeur maximale des règles de diffusion (83 pour un chiffres et données)","code":""},{"path":"/reference/taille_colonnes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Applique des tailles de colonne aux tableaux d'un workbook — taille_colonnes","text":"Rien n'est renvoyé mais le classeur est modifié","code":""},{"path":"/reference/taille_colonnes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Applique des tailles de colonne aux tableaux d'un workbook — taille_colonnes","text":"","code":"library(openxlsx) library(agreste)  ## Création d'un classeur avec deux feuilles et deux tableaux mon_classeur <- createWorkbook()  ajouter_tableau_excel(classeur = mon_classeur,                       tableau = iris,                       nom_feuille = \"iris\",                       ligne_debut = 5,                       col_debut = 2)  ajouter_titre_tableau(classeur = mon_classeur,                       nom_feuille = \"iris\",                       titre = \"Données fleurs iris\",                       col_debut = 2,                       format = \"primeur\") ajouter_source(classeur = mon_classeur,                nom_feuille = \"iris\",                source = \"Ceci est une source quelconque\",                format = \"primeur\",                col_debut = 2,                avec_note = FALSE,                avec_titre = FALSE) ajouter_champ(classeur = mon_classeur,               nom_feuille = \"iris\",               champ = \"France métropolitaine\",               format = \"primeur\",               col_debut = 2,               avec_titre = FALSE)  ajouter_tableau_excel(classeur = mon_classeur,                       tableau = airquality,                       nom_feuille = \"airquality\",                       ligne_debut = 5,                       col_debut = 2)  ajouter_titre_tableau(classeur = mon_classeur,                       nom_feuille = \"airquality\",                       titre = \"Données qualité de l'air\",                       col_debut = 2,                       format = \"primeur\") ajouter_note_lecture(classeur = mon_classeur,                      nom_feuille = \"airquality\",                      note = \"blablabla\",                      format = \"primeur\",                      col_debut = 2,                      avec_titre = FALSE) ajouter_source(classeur = mon_classeur,                nom_feuille = \"airquality\",                source = \"Eurostat\",                format = \"primeur\",                col_debut = 2,                avec_note = TRUE,                avec_titre = FALSE) ajouter_champ(classeur = mon_classeur,               nom_feuille = \"airquality\",               champ = \"Daily air quality measurements in New York, May to September 1973.\",               format = \"primeur\",               col_debut = 2,               avec_titre = FALSE)  ajouter_titre_primeur(classeur = mon_classeur,                       titre = \"Exemple 2022\")  taille_colonnes(classeur = mon_classeur,                 liste_type_donnees = list(c(\"decimal\",                                             \"decimal\",                                             \"decimal\",                                             \"decimal\",                                             \"texte\"),                                           c(\"numerique\",                                             \"numerique\",                                             \"decimal\",                                             \"numerique\",                                             \"numerique\",                                             \"numerique\")),                 largeurs = list(c(\"auto\"), c(\"auto\")),                 format = \"primeur\",                 col_debut = 2)   ## Sauver saveWorkbook(wb = mon_classeur, file = \"tableau.xlsx\", overwrite = TRUE)  ## Ouvrir browseURL(\"tableau.xlsx\")"},{"path":"/stage_killian.html","id":null,"dir":"","previous_headings":"","what":"Stage Killian : faciliter les publications de la SDSAFA","title":"Stage Killian : faciliter les publications de la SDSAFA","text":"Un répertoire pour gérer le stage de Killian : doc, issues…. Sujet Développement et déploiement d’outils facilitant la production des publications statistiques Résultats attendus Création/mise à jour d’un package R contenant des fonctions directement utilisables par les responsables d’enquête pour créer les documents nécessaires à la diffusion des données sur Agreste (https://agreste.agriculture.gouv.fr/agreste-web/). Par exemple : fonction d’export xlsx mis en forme, fonctions de création de graphiques, fonctions de création de cartes, création de modèle de Rmd pour chaque collection, automatisation de la production des “chiffres et données”… Organisation Le stage s’organise en sprints de 2 à 3 semaines (durée à discuter) gérés dans les milestones. Chaque sprint contient des issues à réaliser.","code":""},{"path":"/news/index.html","id":"agreste-120","dir":"Changelog","previous_headings":"","what":"agreste 1.2.0","title":"agreste 1.2.0","text":"ajout de barres de progression dans la console pour suivre l’avancement du formatage messages d’erreur utilisateur plus clairs et plus précis","code":""},{"path":"/news/index.html","id":"agreste-114","dir":"Changelog","previous_headings":"","what":"agreste 1.1.4","title":"agreste 1.1.4","text":"correction de bugs affectant l’écriture des données","code":""},{"path":"/news/index.html","id":"agreste-113","dir":"Changelog","previous_headings":"","what":"agreste 1.1.3","title":"agreste 1.1.3","text":"ajout d’une option pour permettre aux tableaux de dépasser la largeur maximale de 83 possibilité d’utiliser des tableaux de données au format .ods possibilité de formater des lignes en italique correction d’un bug sur le bouton de validation de l’ordre des tableaux dans l’interface","code":""},{"path":"/news/index.html","id":"agreste-112","dir":"Changelog","previous_headings":"","what":"agreste 1.1.2","title":"agreste 1.1.2","text":"Correction de bugs sur l’import de fichiers Rds","code":""},{"path":"/news/index.html","id":"agreste-111","dir":"Changelog","previous_headings":"","what":"agreste 1.1.1","title":"agreste 1.1.1","text":"refonte avec page d’accueil accueillante correction d’une erreur dans la largeur max des tableaux","code":""},{"path":"/news/index.html","id":"agreste-110","dir":"Changelog","previous_headings":"","what":"agreste 1.1.0","title":"agreste 1.1.0","text":"Ajout d’un sommaire avec chapitres et sous-chapitres Première version entièrement fonctionnelle de l’appli","code":""},{"path":"/news/index.html","id":"agreste-102","dir":"Changelog","previous_headings":"","what":"agreste 1.0.2","title":"agreste 1.0.2","text":"Choix du dossier contenant les fichiers de données à formater Ajout de messages utilisateur clairs dans l’interface graphique","code":""},{"path":"/news/index.html","id":"agreste-101","dir":"Changelog","previous_headings":"","what":"agreste 1.0.1","title":"agreste 1.0.1","text":"Possibilité d’importer un plan dans l’app Shiny, de l’éditer et de formater directement ses tableaux","code":""},{"path":"/news/index.html","id":"agreste-030","dir":"Changelog","previous_headings":"","what":"agreste 0.3.0","title":"agreste 0.3.0","text":"Interface graphique Shiny pour créer un plan de formatage, et utiliser la fonction creer_excel_depuis_plan par un bouton","code":""},{"path":"/news/index.html","id":"agreste-029","dir":"Changelog","previous_headings":"","what":"agreste 0.2.9","title":"agreste 0.2.9","text":"Formatage des lignes de niveaux différents de précision (jusqu’à 4) Résolution de bugs concernant le formatage des nombres décimaux inférieurs à 1 Ajout de la possibilité de fusionner des cellules par le plan Ajout d’une fonction read_any_file() qui permet de lire un fichier de type csv, tsv, xlsx, Rds, parquet, ou un objet data.frame","code":""},{"path":"/news/index.html","id":"agreste-028","dir":"Changelog","previous_headings":"","what":"agreste 0.2.8","title":"agreste 0.2.8","text":"Ajout d’une fonction taille_colonnes() pour appliquer une taille de colonnes pour respecter les consignes de la PAO (taille max du tableau de 89) Ajout de messages d’erreur clairs en cas de mauvais paramètres rentrés Formatage des lignes de section, sous-total, précision, total","code":""},{"path":"/news/index.html","id":"agreste-02","dir":"Changelog","previous_headings":"","what":"agreste 0.2","title":"agreste 0.2","text":"ajout d’un Addin pour lancer l’app Shiny de formatage","code":""},{"path":"/news/index.html","id":"agreste-011","dir":"Changelog","previous_headings":"","what":"agreste 0.11","title":"agreste 0.11","text":"Ajout de la fonction app_formatage() pour utiliser le package par une interface graphique.","code":""},{"path":"/news/index.html","id":"agreste-01","dir":"Changelog","previous_headings":"","what":"agreste 0.1","title":"agreste 0.1","text":"Les fonctions suivantes ont été ajoutées : ajouter_champ() ajouter_note_lecture() ajouter_source() ajouter_tableau_excel() ajouter_titre_tableau() carte_aplat() carte_rond_proportionnel() creer_excel_depuis_plan() creer_liste_style_excel() donnees_fond_carte() formater_auto() geler()","code":""},{"path":"/news/index.html","id":"agreste-0009000","dir":"Changelog","previous_headings":"","what":"agreste 0.0.0.9000","title":"agreste 0.0.0.9000","text":"Ajout de NEWS.md pour suivre les changements du package.","code":""}]
